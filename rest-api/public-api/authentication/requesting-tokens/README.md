---
description: Request the token that must be provided in all other API requests
---

# Requesting Tokens

### Introduction

In ETNA Trader, all API requests require a special authentication token to be provided in the header. Whether you want to create a price alert for a user, get a quote on a particular stock, or cancel an order â€” you first have to authorize the user with their unique token \(requests can only be made on behalf of some user\). This token can be generated by making a specific API call where you provide the user's username and their password. In response, you'll receive the above-mentioned token which can be used in all other requests.

Whenever you make such a request, a fresh token will be generated and returned to you. Thus, you can have multiple tokens for each user, and they will all be active until expiration.

{% hint style="info" %}
An authentication token's lifetime is 24 hours. 
{% endhint %}

### Overview

An authentication token for a particular user can be generated by making an API call to the the following URL:

```text
APIBaseURL + /token
```

The header of this request must contain the following three parameters:

**1. Et-App-Key**. This is the unique key of your app that identifies your app when communicating with our service. Contact your administrator to get this key.

**2.** **Username**. This is the username of the user on whose behalf all future requests will be made.

**3. Password**. This is the password of the user on whose behalf all future requests will be made.

### Response

In response to this API request, you'll receive a JSON file that contains the token. Here's an example of such response:

```javascript
{
    "State": "Succeeded",
    "Token": "FAKETokenAAKTQZR0F5K0OY5sfsWcd9rwAAAAACAAAAAAAQZgA/M8HtnoEJR0UxEDagAAAAAOgAAAAAIAACAAAACApaOit8LbBxTVxJXceMgzvN+"
}
```

where:

| Parameter | Description |
| :--- | :--- |
| State | This is the state of the request. Usually the value is set to Succeeded, meaning that the request has been successfully made. |
| Token | This is the token that must be provided in all subsequent API requests as the authentication bearer token.  |

### Common Mistakes

Here are some of the common mistakes that developers make when requesting a token:

#### Failing to Specify the Et-App-Key Parameter

If you specify the wrong Et-App-Key parameter or fail to include it in the header altogether, you'll get the following error:

```javascript
{
    "error": "Application key is not defined or does not exist"
}
```

#### Incorrect or Missing User Credentials

If you specify the wrong user credentials or fail to include them in the request header, you'll get the following error:

```javascript
{
    "State": "Failed",
    "Step": "BaseAuthentication",
    "Reason": "Invalid credentials"
}
```

In the following article we outline in detail all of the required and optional header parameters, the range of response status codes, as well as a comprehensive list of all possible responses.

### Sample Code

The following python script demonstrates how to perform initial authentication in ETNA Trader. 

```python
import requests

class EtnaAPIRequest:

	baseURL = "https://pub-api-et-demo-prod.etnasoft.us/api/"
	EtAppKey = "your EtAppKey from the BO companies widget"

	token = 'uninitialized'

	username = "your username"
	password = "your password"

	# def __init__(self, username, password):
		# self.username = username
		# self.password = password

	def initialAuth(self):
		authenticationRequest = requests.post(self.baseURL + 'token', headers = {"Accept" : "application/json", "Et-App-Key" : self.EtAppKey, "Username":self.username, "Password":self.password})
		print('Authorization status code: ' + str(authenticationRequest.status_code) + '\n')

		try:
			responseJSON = authenticationRequest.json()
			self.token = "Bearer " + responseJSON["Token"]
			return responseJSON
		except:
			return "No response"
			
#Performing initial Authentication
sampleRequest = EtnaAPIRequest()
sampleRequest.initialAuth()
```

